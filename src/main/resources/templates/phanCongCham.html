<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>phan cong cham</title>
</head>
<body>
    <h1>chon can bo cham thi</h1>
    <form name="themHoiDongCham"  th:action="@{'/phanCongCham/' + ${detai.getIDDeTai()} + '/' + ${viewer.getTaiKhoan()}}" onsubmit="return validateForm()" method="POST">
        <table>
            <tr>
                <th>Ten</th>
                <th>Tai Khoan</th>
                <th>Dia chi</th>
                <th>linh vuc</th>
                <th>cham thi</th>
                <th><input type="hidden"></th>
            </tr>
            <tr th:each="canbo : ${linhVucCuaCanBo}">
                <td th:text="${canbo.key.getTen()}"></td>
                <td th:text="${canbo.key.getTaiKhoan()}"></td>
                <td th:text="${canbo.key.getDiaChi()}"></td>
                <td>
                    <select>
                        <option th:each="linhvuc : ${canbo.value}" th:text="${linhvuc.getTenLinhVuc()}"></option>
                    </select>
                </td>
                <td>
                    <input class="checkList" type="checkbox" th:value="${canbo.key.getID()}" th:checked="${hoidongcham.contains(canbo.key.getID())}">
                </td>
            </tr>
        </table>
        <span th:field="${checked}" >
            <input type="hidden" name="checked" th:value="${checked}">
        </span>
        <span th:field="${notChecked}" >
            <input type="hidden" name="notChecked" th:value="${notChecked}">
        </span>
        <input type="submit" value="change">
    </form>
    <script th:inline="javascript">
        function validateForm() {
            let Checked = "";
            let notCheck = "";
            var inputElements =  document.getElementsByClassName('checkList');
            for(var i = 0; i < inputElements.length ; i++){
                if(inputElements[i].checked){
                    // checkedValue = inputElements[i].value;
                    Checked = Checked + "/" + inputElements[i].value;
                } else {
                    notCheck = notCheck + "/" + inputElements[i].value;
                }
            }
            document.forms["themHoiDongCham"]["checked"].value = Checked;
            document.forms["themHoiDongCham"]["notChecked"].value = notCheck;
            return true;
        }
    </script>
</body>
</html>